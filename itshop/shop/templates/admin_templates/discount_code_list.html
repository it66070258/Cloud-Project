{% extends 'admin_templates/base.html' %}
{% load humanize %}

{% block title %}โค้ดส่วนลด - IT Shop{% endblock %}

{% block code_button %}
<button
    class="w-full p-3 ps-4 rounded-md text-left text-white bg-gradient-to-bl from-purple-400 to-purple-900 hover:to-purple-500 hover:cursor-pointer">
    <i class="fa-solid fa-ticket me-2"></i>
    <span class="font-regular">โค้ดส่วนลด</span>
</button>
{% endblock %}

{% block head %}
<div class="flex justify-between items-center">
    <h1 class="text-2xl ms-1 text-gray-600">โค้ดส่วนลด</h1>
    <a href="{% url 'code_create' %}">
        <button
            class="w-full p-2 rounded-md text-left bg-purple-700 text-white hover:bg-purple-600 hover:cursor-pointer">
            <i class="fa-solid fa-plus"></i>
            <span class="font-regular">เพิ่มโค้ดส่วนลด</span>
        </button>
    </a>
</div>
{% endblock %}

{% block content %}
<table class="w-full">
    <thead>
        <tr class="border-b border-gray-300 text-sm text-left">
            <th class="p-4">โค้ด</th>
            <th class="p-4">จำนวนส่วนลด</th>
            <th class="p-4">วันเริ่มต้น</th>
            <th class="p-4">วันสิ้นสุด</th>
            <th class="p-4">สถานะ</th>
            <th class="p-4">ใช้ไปแล้ว</th>
            <th class="p-4">จัดการ</th>
        </tr>
    </thead>
    <tbody>
        {% for code in discount_codes %}
        <tr class="border-b border-gray-200 text-sm">
            <td class="p-4 font-medium">{{ code.code }}</td>
            <td class="p-4">
                {% if code.code_type == 'PERCENT' %}
                {{ code.value|floatformat:-2 }}%
                {% else %}
                ฿{{ code.value|floatformat:-2|intcomma }}
                {% endif %}
            </td>
            <td class="p-4">{{ code.start_date|date:"d/m/Y H:i" }}</td>
            <td class="p-4">
                {% if code.end_date %}
                {{ code.end_date|date:"d/m/Y H:i" }}
                {% else %}
                -
                {% endif %}
            </td>
            <td class="p-4">
                {% if code.is_active %}
                <div class="inline-flex items-center gap-1 px-3 py-1 rounded-full bg-green-300 text-green-700 text-xs">
                    <i class="fa-solid fa-circle-check"></i>
                    เปิดใช้งาน
                </div>
                {% else %}
                <div class="inline-flex items-center gap-1 px-3 py-1 rounded-full bg-red-300 text-red-600 text-xs">
                    <i class="fa-solid fa-circle-xmark"></i>
                    ปิดใช้งาน
                </div>
                {% endif %}
            </td>
            <td class="p-4">{{ code.usage_count|intcomma }}</td>
            <td class="p-4">
                <a href="{% url 'code_edit' code.id %}">
                    <button
                        class="px-2 py-1 text-white bg-yellow-500 hover:bg-yellow-600/70 rounded-md text-sm hover:cursor-pointer">
                        <i class="fa-solid fa-pencil-alt"></i>
                        แก้ไข
                    </button>
                </a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="8" class="text-center text-gray-500 py-4">
                ยังไม่มีโค้ดส่วนลด
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}